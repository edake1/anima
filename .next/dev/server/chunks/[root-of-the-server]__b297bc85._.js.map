{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/dakedwin/personal-projects/anima/src/app/api/metaculus/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\n\nconst METACULUS_BASE = 'https://www.metaculus.com/api2';\n\n// Key AGI-related question IDs on Metaculus\nconst TRACKED_QUESTIONS = [\n  5121,  // Date of AGI\n  3479,  // Transformative AI by 2036\n  4118,  // Weak AGI by 2030\n  6321,  // AI beats humans at all tasks by 2030\n];\n\nexport interface MetaculusQuestion {\n  id: number;\n  title: string;\n  url: string;\n  communityPrediction: number | null;\n  resolution: number | null;\n  closeTime: string;\n  publishTime: string;\n  numForecasters: number;\n  description: string;\n}\n\nasync function fetchQuestion(id: number): Promise<MetaculusQuestion | null> {\n  try {\n    const res = await fetch(`${METACULUS_BASE}/questions/${id}/`, {\n      headers: { 'Content-Type': 'application/json' },\n      next: { revalidate: 3600 }, // Cache for 1 hour\n    });\n    if (!res.ok) return null;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const data: any = await res.json();\n    const cp = data?.community_prediction?.full?.q2 ?? null;\n    return {\n      id: data.id,\n      title: data.title,\n      url: `https://www.metaculus.com/questions/${data.id}/`,\n      communityPrediction: cp !== null ? Math.round(cp * 100) : null,\n      resolution: data.resolution,\n      closeTime: data.close_time,\n      publishTime: data.publish_time,\n      numForecasters: data.number_of_forecasters ?? 0,\n      description: data.description ?? '',\n    };\n  } catch {\n    return null;\n  }\n}\n\nexport async function GET(request: Request) {\n  const { searchParams } = new URL(request.url);\n  const idParam = searchParams.get('id');\n\n  if (idParam) {\n    const id = parseInt(idParam, 10);\n    if (isNaN(id)) {\n      return NextResponse.json({ error: 'Invalid question ID' }, { status: 400 });\n    }\n    const question = await fetchQuestion(id);\n    if (!question) {\n      return NextResponse.json({ error: 'Question not found' }, { status: 404 });\n    }\n    return NextResponse.json(question);\n  }\n\n  // Return all tracked questions\n  const results = await Promise.all(TRACKED_QUESTIONS.map(fetchQuestion));\n  const valid = results.filter((q): q is MetaculusQuestion => q !== null);\n\n  return NextResponse.json({\n    questions: valid,\n    fetchedAt: new Date().toISOString(),\n  });\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,iBAAiB;AAEvB,4CAA4C;AAC5C,MAAM,oBAAoB;IACxB;IACA;IACA;IACA;CACD;AAcD,eAAe,cAAc,EAAU;IACrC,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,GAAG,eAAe,WAAW,EAAE,GAAG,CAAC,CAAC,EAAE;YAC5D,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM;gBAAE,YAAY;YAAK;QAC3B;QACA,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;QACpB,8DAA8D;QAC9D,MAAM,OAAY,MAAM,IAAI,IAAI;QAChC,MAAM,KAAK,MAAM,sBAAsB,MAAM,MAAM;QACnD,OAAO;YACL,IAAI,KAAK,EAAE;YACX,OAAO,KAAK,KAAK;YACjB,KAAK,CAAC,oCAAoC,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;YACtD,qBAAqB,OAAO,OAAO,KAAK,KAAK,CAAC,KAAK,OAAO;YAC1D,YAAY,KAAK,UAAU;YAC3B,WAAW,KAAK,UAAU;YAC1B,aAAa,KAAK,YAAY;YAC9B,gBAAgB,KAAK,qBAAqB,IAAI;YAC9C,aAAa,KAAK,WAAW,IAAI;QACnC;IACF,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,IAAI,OAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,UAAU,aAAa,GAAG,CAAC;IAEjC,IAAI,SAAS;QACX,MAAM,KAAK,SAAS,SAAS;QAC7B,IAAI,MAAM,KAAK;YACb,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QACA,MAAM,WAAW,MAAM,cAAc;QACrC,IAAI,CAAC,UAAU;YACb,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC1E;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B;IAEA,+BAA+B;IAC/B,MAAM,UAAU,MAAM,QAAQ,GAAG,CAAC,kBAAkB,GAAG,CAAC;IACxD,MAAM,QAAQ,QAAQ,MAAM,CAAC,CAAC,IAA8B,MAAM;IAElE,OAAO,gJAAY,CAAC,IAAI,CAAC;QACvB,WAAW;QACX,WAAW,IAAI,OAAO,WAAW;IACnC;AACF"}}]
}